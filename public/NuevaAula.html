<!DOCTYPE html>
<html>
<head>
   <meta charset='utf-8'>
   <meta http-equiv='X-UA-Compatible' content='IE=edge'>
   <title>NuevaAula</title>
   <meta name='Reserva de aulas' content='width=device-width, initial-scale=1'>
   <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
   <link rel="stylesheet" href="Reserva.css">
   <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
   <script src='main.js'></script>
</head>
<body>
  <div class="w3-sidebar w3-bar-block w3-border-right" style="display:none" id="mySidebar">
     <button onclick="w3_close()" class="w3-bar-item w3-large">Cerrar &times;</button>
     <a href="login.html" class="w3-bar-item w3-button">Login</a>
     <a href="inicio.html" class="w3-bar-item w3-button">Inicio</a>
     <a href="Reserva.html" class="w3-bar-item w3-button">Reservar</a>
     <a href="busquedaAdmi.html" class="w3-bar-item w3-button">Admin</a>
     <a href="Historial.html" class="w3-bar-item w3-button">Historial</a>
  </div>
  <script src="navbar.js"></script>
  <div class="w3-teal">
    <button class="w3-button w3-teal w3-xlarge" onclick="w3_open()">☰</button>
    <div class="w3-container">
      <h1>INGRESAR NUEVAS AULAS</h1>
    </div>

    <div class="w3-container w3-white ">
      <h2>Rellene todos los campos.</h2>
      <div class="w3-row-padding w3-round-xlarge">
          <form id="aulaForm" action="http://localhost:5500/agregar-datos-aula" method="POST" onsubmit="return validarFormulario()">
              <div class="w3-third">
                  <label for="codAula">Aula:</label>
                  <input class="w3-input w3-border" type="text" id="codAula" name="codAula" placeholder="Aula" required>
              </div>
              <div class="w3-third">
                  <label for="Capacidad">Capacidad:</label>
                  <input class="w3-input w3-border" type="text" id="Capacidad" name="Capacidad" placeholder="Capacidad" required>
              </div>
              <div class="w3-third">
                  <label for="Descripcion">Descripción:</label>
                  <input class="w3-input w3-border" type="text" id="Descripcion" name="Descripcion" placeholder="Descripción" required>
              </div>
              <button class="w3-btn w3-block w3-blue w3-center" style="width:50%" onclick="agregarAula()">agregar Aula</button>
          </form>
      </div>
      <br>
      <br>
  </div>

    <div class="w3-container">
      <h1>INGRESAR AULAS POR LOTE</h1>
    </div>
         <div class="w3-container w3-white">
          <h3>Para ingresar por lote, tiene que tener un archivo.csv </h3>
          <form id="archivoForm" action="/procesar-archivo-csv" method="POST" enctype="multipart/form-data">
            <label for="archivo">Selecciona un archivo CSV:</label>
            <input type="file" name="archivo" id="archivo" accept=".csv">
            <br>
            <br>
            <button class="w3-btn w3-block w3-blue w3-center" style="width:50%" onclick="subirArchivo()">Subir Archivo</button>
        </form>
         </div>
  </div>
  <script>
    function validarFormulario() {
        // Obtener referencias a los campos del formulario
        const codAulaInput = document.getElementById('codAula');
        const capacidadInput = document.getElementById('Capacidad');
        const descripcionInput = document.getElementById('Descripcion');
    
        // Verificar que los campos no estén vacíos
        if (codAulaInput.value.trim() === '' || descripcionInput.value.trim() === '') {
            alert('Por favor, rellene todos los campos.');
            return false; // Detener el envío del formulario
        }
    
        // Verificar que capacidad sea un número entero
        const capacidadValue = parseInt(capacidadInput.value);
        if (isNaN(capacidadValue) || capacidadValue % 1 !== 0) {
            alert('La capacidad debe ser un número entero.');
            return false; // Detener el envío del formulario
        }
    
        // Si todas las validaciones son exitosas, retorna true
        return true;
    }
    </script>



  <script>
    function agregarAula() {
    const form = document.getElementById('aulaForm');
    const formData = new FormData(form);

    // Realiza una solicitud POST al servidor para agregar los datos
    fetch('http://localhost:5500/agregar-datos-aula', {
        method: 'POST',
        body: formData,
        headers: {
          'Content-Type': 'application/json',
        },
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`Error en la solicitud: ${response.status} - ${response.statusText}`);
        }
        return response.json();
    })
    .then(data => {
        console.log('Respuesta del servidor:', data);
    })
    .catch(error => {
        console.error('Error al agregar aula:', error);
    });
}

  </script>

  <script>
    
function subirArchivo() {
  const form = document.getElementById('archivoForm');
  const formData = new FormData(form);

  fetch('/procesar-archivo-csv', {
      method: 'POST',
      body: formData,
  })
  .then(response => response.json())
  .then(data => {
   
      console.log(data);
  })
  .catch(error => {
      console.error('Error al subir archivo CSV:', error);
  });
}
  </script>

</body>
</html>